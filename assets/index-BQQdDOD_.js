import{_ as M,u as R,o as O,m as A,a as H,d as G,r as _,b as V,c as J,e as x,f as k,g as l,h as K,w as a,i as p,t as y,j as c,F as w,k as Q,l as W,n as X,E as Z,p as ee,q as oe,s as le,v as te,x as ae}from"./index-BUOJNwMM.js";import{E as ne,a as se,b as ie,c as re,d as me,e as pe}from"./index-DR_6FQwc.js";import{E as ue}from"./index-D8gJjlsW.js";import"./scroll-BlHBa8yx.js";const de={class:"flex-box"},_e={class:"pagination-info"},ce={class:"dialog-footer"},fe={__name:"index",setup(ge){const S=R();O(()=>{u(),A().then(({data:t})=>{console.log(t,"permission"),f.value=t.data})});const u=()=>{H(i).then(({data:t})=>{console.log(t,"admin");const{list:e,total:r}=t.data;e.forEach(n=>{n.create_time=G(n.create_time).format("YYYY-MM-DD")}),d.list=e,d.total=r})},d=_({list:[],total:0}),i=_({pageNum:1,pageSize:10}),f=V([]),N=t=>{const e=f.value.find(r=>r.id===t);return e?e.name:"超级管理员"},U=t=>{console.log(`${t} items per page`),i.pageSize=t,u()},D=t=>{console.log(`current page: ${t}`),i.pageNum=t,u()},m=V(!1),s=_({mobile:"",name:"",permissions_id:""}),g=V(null),$=(t={})=>{m.value=!0,Object.assign(s,{mobile:t.mobile,permissions_id:t.permissions_id,name:t.name})},B=()=>{m.value=!1,g.value.resetFields()},F=_({name:[{required:!0,message:"请输入名称",trigger:"blur"}],permission_id:[{required:!0,message:"请选择权限",trigger:"blur"}]}),I=async t=>{t&&await t.validate((e,r)=>{if(e){const{name:n,permissions_id:b}=s;W({name:n,permissions_id:b}).then(({data:v})=>{v.code===1e4&&(m.value=!1,u())})}else return console.log("error submit!!",r),!1})};return(t,e)=>{const r=X,n=ne,b=se,v=J("Clock"),j=Z,C=ee,P=ie,T=re,z=oe,E=le,Y=pe,h=me,q=te,L=ue;return x(),k(w,null,[l(r,{route:K(S)},null,8,["route"]),l(P,{data:d.list,stripe:"",style:{width:"100%"}},{default:a(()=>[l(n,{prop:"id",label:"ID"}),l(n,{prop:"name",label:"昵称"}),l(n,{prop:"permissions_id",label:"所属组别"},{default:a(o=>[p(y(N(o.row.permissions_id)),1)]),_:1}),l(n,{prop:"mobile",label:"手机号"}),l(n,{prop:"active",label:"状态"},{default:a(o=>[l(b,{class:"ml-2",type:o.row.active?"success":"danger"},{default:a(()=>[p(y(o.row.active?"正常":"失效"),1)]),_:2},1032,["type"])]),_:1}),l(n,{label:"创建时间"},{default:a(o=>[c("div",de,[l(j,{style:{"margin-right":"5px"}},{default:a(()=>[l(v)]),_:1}),c("span",null,y(o.row.create_time),1)])]),_:1}),l(n,{label:"操作",fixed:"right"},{default:a(o=>[l(C,{type:"primary",size:"small",onClick:be=>$(o.row)},{default:a(()=>e[8]||(e[8]=[p(" 编辑 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),c("div",_e,[l(T,{"current-page":i.pageNum,"onUpdate:currentPage":e[0]||(e[0]=o=>i.pageNum=o),"page-size":i.pageSize,"onUpdate:pageSize":e[1]||(e[1]=o=>i.pageSize=o),size:"small","page-sizes":[10,20,30,40],layout:"total, sizes, prev, pager, next, jumper",total:d.total,onSizeChange:U,onCurrentChange:D},null,8,["current-page","page-size","total"])]),l(L,{modelValue:m.value,"onUpdate:modelValue":e[7]||(e[7]=o=>m.value=o),"before-close":B,title:"编辑用户",width:"500"},{footer:a(()=>[c("div",ce,[l(C,{onClick:e[5]||(e[5]=o=>m.value=!1)},{default:a(()=>e[9]||(e[9]=[p("取消")])),_:1}),l(C,{type:"primary",onClick:e[6]||(e[6]=o=>I(g.value))},{default:a(()=>e[10]||(e[10]=[p(" 提交 ")])),_:1})])]),default:a(()=>[l(q,{ref_key:"formRef",ref:g,model:s,rules:F,"label-width":"80px","label-position":"left"},{default:a(()=>[l(E,{label:"手机号",prop:"mobile"},{default:a(()=>[l(z,{disabled:"",modelValue:s.mobile,"onUpdate:modelValue":e[2]||(e[2]=o=>s.mobile=o)},null,8,["modelValue"])]),_:1}),l(E,{label:"昵称",prop:"name"},{default:a(()=>[l(z,{modelValue:s.name,"onUpdate:modelValue":e[3]||(e[3]=o=>s.name=o),placeholder:"请填写权限名称"},null,8,["modelValue"])]),_:1}),l(E,{label:"菜单权限",prop:"permissions_id"},{default:a(()=>[l(h,{modelValue:s.permissions_id,"onUpdate:modelValue":e[4]||(e[4]=o=>s.permissions_id=o),placeholder:"请选择菜单权限",style:{width:"240px"}},{default:a(()=>[(x(!0),k(w,null,Q(f.value,o=>(x(),ae(Y,{key:o.id,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}}},xe=M(fe,[["__scopeId","data-v-f778bd8e"]]);export{xe as default};
