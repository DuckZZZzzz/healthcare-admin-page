import{aP as B,bf as Ie,ai as me,aU as H,c7 as pe,al as ce,C as ne,ck as ve,cl as _e,cm as ze,a5 as ge,D as we,aZ as Le,b as k,cn as Ce,a0 as Se,a6 as y,O as ue,P as ye,o as be,e as h,x as de,g as v,w as C,j as b,U as m,h as a,X as fe,V as Ee,W as S,E as O,bR as Ne,f as x,F as te,cb as xe,cc as Oe,co as Te,cp as Re,T as $e,cq as Ae,cr as Be,k as Ve,R as Me,S as Pe,I as ae,b6 as Xe,b7 as Ye,B as he,a2 as V,a3 as A,cs as De,ay as ke,ct as Fe,cu as He,cv as We,t as je,b4 as Ke,ch as Ue,$ as Ze}from"./index-BUOJNwMM.js";import{d as qe,a as Ge}from"./scroll-BlHBa8yx.js";const Je=(i,p)=>{if(!B||!i||!p)return!1;const s=i.getBoundingClientRect();let f;return p instanceof Element?f=p.getBoundingClientRect():f={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},s.top<f.bottom&&s.bottom>f.top&&s.right>f.left&&s.left<f.right};var Qe="Expected a function";function ie(i,p,s){var f=!0,l=!0;if(typeof i!="function")throw new TypeError(Qe);return Ie(s)&&(f="leading"in s?!!s.leading:f,l="trailing"in s?!!s.trailing:l),qe(i,p,{leading:f,maxWait:p,trailing:l})}const ea=me({urlList:{type:H(Array),default:()=>pe([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:H(String)}}),aa={close:()=>!0,switch:i=>ce(i),rotate:i=>ce(i)},ta=["src","crossorigin"],na=ne({name:"ElImageViewer"}),sa=ne({...na,props:ea,emits:aa,setup(i,{expose:p,emit:s}){var f;const l=i,w={CONTAIN:{name:"contain",icon:ve(_e)},ORIGINAL:{name:"original",icon:ve(ze)}},{t:se}=ge(),c=we("image-viewer"),{nextZIndex:M}=Le(),E=k(),N=k([]),T=Ce(),I=k(!0),u=k(l.initialIndex),R=Se(w.CONTAIN),o=k({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),P=k((f=l.zIndex)!=null?f:M()),oe=y(()=>{const{urlList:t}=l;return t.length<=1}),W=y(()=>u.value===0),j=y(()=>u.value===l.urlList.length-1),X=y(()=>l.urlList[u.value]),le=y(()=>[c.e("btn"),c.e("prev"),c.is("disabled",!l.infinite&&W.value)]),K=y(()=>[c.e("btn"),c.e("next"),c.is("disabled",!l.infinite&&j.value)]),Y=y(()=>{const{scale:t,deg:n,offsetX:r,offsetY:_,enableTransition:L}=o.value;let g=r/t,z=_/t;switch(n%360){case 90:case-270:[g,z]=[z,-g];break;case 180:case-180:[g,z]=[-g,-z];break;case 270:case-90:[g,z]=[-z,g];break}const $={transform:`scale(${t}) rotate(${n}deg) translate(${g}px, ${z}px)`,transition:L?"transform .3s":""};return R.value.name===w.CONTAIN.name&&($.maxWidth=$.maxHeight="100%"),$});function D(){U(),s("close")}function re(){const t=ie(r=>{switch(r.code){case A.esc:l.closeOnPressEscape&&D();break;case A.space:Q();break;case A.left:ee();break;case A.up:d("zoomIn");break;case A.right:e();break;case A.down:d("zoomOut");break}}),n=ie(r=>{const _=r.deltaY||r.deltaX;d(_<0?"zoomIn":"zoomOut",{zoomRate:l.zoomRate,enableTransition:!1})});T.run(()=>{V(document,"keydown",t),V(document,"wheel",n)})}function U(){T.stop()}function Z(){I.value=!1}function q(t){I.value=!1,t.target.alt=se("el.image.error")}function G(t){if(I.value||t.button!==0||!E.value)return;o.value.enableTransition=!1;const{offsetX:n,offsetY:r}=o.value,_=t.pageX,L=t.pageY,g=ie($=>{o.value={...o.value,offsetX:n+$.pageX-_,offsetY:r+$.pageY-L}}),z=V(document,"mousemove",g);V(document,"mouseup",()=>{z()}),t.preventDefault()}function J(){o.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function Q(){if(I.value)return;const t=De(w),n=Object.values(w),r=R.value.name,L=(n.findIndex(g=>g.name===r)+1)%t.length;R.value=w[t[L]],J()}function F(t){const n=l.urlList.length;u.value=(t+n)%n}function ee(){W.value&&!l.infinite||F(u.value-1)}function e(){j.value&&!l.infinite||F(u.value+1)}function d(t,n={}){if(I.value)return;const{minScale:r,maxScale:_}=l,{zoomRate:L,rotateDeg:g,enableTransition:z}={zoomRate:l.zoomRate,rotateDeg:90,enableTransition:!0,...n};switch(t){case"zoomOut":o.value.scale>r&&(o.value.scale=Number.parseFloat((o.value.scale/L).toFixed(3)));break;case"zoomIn":o.value.scale<_&&(o.value.scale=Number.parseFloat((o.value.scale*L).toFixed(3)));break;case"clockwise":o.value.deg+=g,s("rotate",o.value.deg);break;case"anticlockwise":o.value.deg-=g,s("rotate",o.value.deg);break}o.value.enableTransition=z}return ue(X,()=>{ye(()=>{const t=N.value[0];t!=null&&t.complete||(I.value=!0)})}),ue(u,t=>{J(),s("switch",t)}),be(()=>{var t,n;re(),(n=(t=E.value)==null?void 0:t.focus)==null||n.call(t)}),p({setActiveItem:F}),(t,n)=>(h(),de(Ye,{to:"body",disabled:!t.teleported},[v(Xe,{name:"viewer-fade",appear:""},{default:C(()=>[b("div",{ref_key:"wrapper",ref:E,tabindex:-1,class:m(a(c).e("wrapper")),style:fe({zIndex:P.value})},[b("div",{class:m(a(c).e("mask")),onClick:n[0]||(n[0]=Ee(r=>t.hideOnClickModal&&D(),["self"]))},null,2),S(" CLOSE "),b("span",{class:m([a(c).e("btn"),a(c).e("close")]),onClick:D},[v(a(O),null,{default:C(()=>[v(a(Ne))]),_:1})],2),S(" ARROW "),a(oe)?S("v-if",!0):(h(),x(te,{key:0},[b("span",{class:m(a(le)),onClick:ee},[v(a(O),null,{default:C(()=>[v(a(xe))]),_:1})],2),b("span",{class:m(a(K)),onClick:e},[v(a(O),null,{default:C(()=>[v(a(Oe))]),_:1})],2)],64)),S(" ACTIONS "),b("div",{class:m([a(c).e("btn"),a(c).e("actions")])},[b("div",{class:m(a(c).e("actions__inner"))},[v(a(O),{onClick:n[1]||(n[1]=r=>d("zoomOut"))},{default:C(()=>[v(a(Te))]),_:1}),v(a(O),{onClick:n[2]||(n[2]=r=>d("zoomIn"))},{default:C(()=>[v(a(Re))]),_:1}),b("i",{class:m(a(c).e("actions__divider"))},null,2),v(a(O),{onClick:Q},{default:C(()=>[(h(),de($e(a(R).icon)))]),_:1}),b("i",{class:m(a(c).e("actions__divider"))},null,2),v(a(O),{onClick:n[3]||(n[3]=r=>d("anticlockwise"))},{default:C(()=>[v(a(Ae))]),_:1}),v(a(O),{onClick:n[4]||(n[4]=r=>d("clockwise"))},{default:C(()=>[v(a(Be))]),_:1})],2)],2),S(" CANVAS "),b("div",{class:m(a(c).e("canvas"))},[(h(!0),x(te,null,Ve(t.urlList,(r,_)=>Me((h(),x("img",{ref_for:!0,ref:L=>N.value[_]=L,key:r,src:r,style:fe(a(Y)),class:m(a(c).e("img")),crossorigin:t.crossorigin,onLoad:Z,onError:q,onMousedown:G},null,46,ta)),[[Pe,_===u.value]])),128))],2),ae(t.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var oa=he(sa,[["__file","image-viewer.vue"]]);const la=ke(oa),ra=me({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:H([String,Object])},previewSrcList:{type:H(Array),default:()=>pe([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:H(String)}}),ia={load:i=>i instanceof Event,error:i=>i instanceof Event,switch:i=>ce(i),close:()=>!0,show:()=>!0},ca=["src","loading","crossorigin"],ua={key:0},da=ne({name:"ElImage",inheritAttrs:!1}),fa=ne({...da,props:ra,emits:ia,setup(i,{emit:p}){const s=i;let f="";const{t:l}=ge(),w=we("image"),se=Fe(),c=He(),M=k(),E=k(!1),N=k(!0),T=k(!1),I=k(),u=k(),R=B&&"loading"in HTMLImageElement.prototype;let o,P;const oe=y(()=>[w.e("inner"),X.value&&w.e("preview"),N.value&&w.is("loading")]),W=y(()=>se.style),j=y(()=>{const{fit:e}=s;return B&&e?{objectFit:e}:{}}),X=y(()=>{const{previewSrcList:e}=s;return Array.isArray(e)&&e.length>0}),le=y(()=>{const{previewSrcList:e,initialIndex:d}=s;let t=d;return d>e.length-1&&(t=0),t}),K=y(()=>s.loading==="eager"?!1:!R&&s.loading==="lazy"||s.lazy),Y=()=>{B&&(N.value=!0,E.value=!1,M.value=s.src)};function D(e){N.value=!1,E.value=!1,p("load",e)}function re(e){N.value=!1,E.value=!0,p("error",e)}function U(){Je(I.value,u.value)&&(Y(),G())}const Z=We(U,200,!0);async function q(){var e;if(!B)return;await ye();const{scrollContainer:d}=s;Ue(d)?u.value=d:Ze(d)&&d!==""?u.value=(e=document.querySelector(d))!=null?e:void 0:I.value&&(u.value=Ge(I.value)),u.value&&(o=V(u,"scroll",Z),setTimeout(()=>U(),100))}function G(){!B||!u.value||!Z||(o==null||o(),u.value=void 0)}function J(e){if(e.ctrlKey){if(e.deltaY<0)return e.preventDefault(),!1;if(e.deltaY>0)return e.preventDefault(),!1}}function Q(){X.value&&(P=V("wheel",J,{passive:!1}),f=document.body.style.overflow,document.body.style.overflow="hidden",T.value=!0,p("show"))}function F(){P==null||P(),document.body.style.overflow=f,T.value=!1,p("close")}function ee(e){p("switch",e)}return ue(()=>s.src,()=>{K.value?(N.value=!0,E.value=!1,G(),q()):Y()}),be(()=>{K.value?q():Y()}),(e,d)=>(h(),x("div",{ref_key:"container",ref:I,class:m([a(w).b(),e.$attrs.class]),style:fe(a(W))},[E.value?ae(e.$slots,"error",{key:0},()=>[b("div",{class:m(a(w).e("error"))},je(a(l)("el.image.error")),3)]):(h(),x(te,{key:1},[M.value!==void 0?(h(),x("img",Ke({key:0},a(c),{src:M.value,loading:e.loading,style:a(j),class:a(oe),crossorigin:e.crossorigin,onClick:Q,onLoad:D,onError:re}),null,16,ca)):S("v-if",!0),N.value?(h(),x("div",{key:1,class:m(a(w).e("wrapper"))},[ae(e.$slots,"placeholder",{},()=>[b("div",{class:m(a(w).e("placeholder"))},null,2)])],2)):S("v-if",!0)],64)),a(X)?(h(),x(te,{key:2},[T.value?(h(),de(a(la),{key:0,"z-index":e.zIndex,"initial-index":a(le),infinite:e.infinite,"zoom-rate":e.zoomRate,"min-scale":e.minScale,"max-scale":e.maxScale,"url-list":e.previewSrcList,crossorigin:e.crossorigin,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:F,onSwitch:ee},{default:C(()=>[e.$slots.viewer?(h(),x("div",ua,[ae(e.$slots,"viewer")])):S("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):S("v-if",!0)],64)):S("v-if",!0)],6))}});var va=he(fa,[["__file","image.vue"]]);const ga=ke(va);export{ga as E};
